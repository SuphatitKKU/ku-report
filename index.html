<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Firebase Web Push</title>
</head>
<body>
  <h2>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏î‡πâ‡∏ß‡∏¢ Firebase</h2>
  <button id="enable-push">‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
    import { getMessaging, getToken, onMessage } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-messaging.js";

    // üîß Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyAXqgO7tadgM6q6vD7ajdToC-aP6FticWs",
      authDomain: "ku-report.firebaseapp.com",
      projectId: "ku-report",
      storageBucket: "ku-report.firebasestorage.app",
      messagingSenderId: "1029958664659",
      appId: "1:1029958664659:web:e336f2312dd8e5574e2f26"
    };

    const app = initializeApp(firebaseConfig);
    const messaging = getMessaging(app);

    // ‚úÖ ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á token
    document.getElementById("enable-push").addEventListener("click", async () => {
      try {
        const permission = await Notification.requestPermission();
        if (permission === 'granted') {
          const token = await getToken(messaging, {
            vapidKey: "YOUR_PUBLIC_VAPID_KEY_HERE"
          });
          console.log("‚úÖ FCM Token:", token);
          alert("Token ‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Console ‡πÅ‡∏•‡πâ‡∏ß");
        } else {
          alert("‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô");
        }
      } catch (err) {
        console.error("üî• FCM error:", err);
      }
    });

    // üéØ ‡πÅ‡∏™‡∏î‡∏á Notification ‡∏Ç‡∏ì‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà
    onMessage(messaging, (payload) => {
      console.log("üì© Message received: ", payload);
      const { title, body } = payload.notification;
      new Notification(title, { body });
    });
  </script>
</body>
</html>
